@startuml
set separator none
title PassGuard Server Application - Dynamic

left to right direction

!include <C4/C4>
!include <C4/C4_Context>
!include <C4/C4_Component>

Container_Boundary("IdentitySolution.PassGuardServerApplication_boundary", "PassGuard Server Application", $tags="") {
  Component(IdentitySolution.PassGuardServerApplication.credentialModule, "credentialModule", $techn="NextJS Module", $descr="credential module", $tags="", $link="")
  Component(IdentitySolution.PassGuardServerApplication.serviceModule, "serviceModule", $techn="NextJS Module", $descr="service module", $tags="", $link="")
  Component(IdentitySolution.PassGuardServerApplication.userModule, "userModule", $techn="NextJS Module", $descr="user module", $tags="", $link="")
}

System(3rdPartyApplication, "3rd-Party Application", $descr="A system to use PassGuard as a identity provider", $tags="", $link="")

Rel(3rdPartyApplication, IdentitySolution.PassGuardServerApplication.credentialModule, "1. request with {service_id, user_id, domain}", $techn="", $tags="", $link="")
Rel(IdentitySolution.PassGuardServerApplication.credentialModule, IdentitySolution.PassGuardServerApplication.serviceModule, "2. request to validate", $techn="", $tags="", $link="")
Rel(IdentitySolution.PassGuardServerApplication.serviceModule, IdentitySolution.PassGuardServerApplication.userModule, "3. proceed user creation with duplication checking", $techn="", $tags="", $link="")
Rel(IdentitySolution.PassGuardServerApplication.credentialModule, 3rdPartyApplication, "4. response", $techn="", $tags="", $link="")

SHOW_LEGEND(true)
@enduml